import{_ as o,o as i,c as r,z as s,E as t,B as e,O as l,a,G as p}from"./chunks/framework.aacc0fa0.js";const Q=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"C2.md"}'),m={name:"C2.md"},c=l(`<div class="info custom-block"><p class="custom-block-title">INFO</p><p>笔记</p></div><h2 id="about" tabindex="-1">About <a class="header-anchor" href="#about" aria-label="Permalink to &quot;About&quot;">​</a></h2><p>C&amp;C（command and control），攻击者使用命令和控制基础设施向受害者发出指令</p><h2 id="c2" tabindex="-1">C2 <a class="header-anchor" href="#c2" aria-label="Permalink to &quot;C2&quot;">​</a></h2><ul><li>Apfell</li><li>Caldera</li><li>Cobalt Strike</li><li>Covenant</li><li>Dali</li><li>Empire</li><li>EvilOSX</li><li>Faction C2</li><li>FlyingAFalseFlag</li><li>godoh</li><li>ibombshell</li><li>INNUENDO</li><li>Koadic C3</li><li>MacShellSwift</li><li>Metasploit</li><li>Merlin</li><li>Nuages</li><li>Octopus</li><li>PoshC2</li><li>Prismatica</li><li>PowerHub</li><li>Red Team Toolkit</li><li>ReverseTCPShell</li><li>SCYTHE</li><li>SilentTrinity</li><li>Sliver</li><li>Trevor C2</li><li>Weasel</li></ul><h2 id="detection" tabindex="-1">Detection <a class="header-anchor" href="#detection" aria-label="Permalink to &quot;Detection&quot;">​</a></h2><h3 id="long-connections" tabindex="-1">Long Connections <a class="header-anchor" href="#long-connections" aria-label="Permalink to &quot;Long Connections&quot;">​</a></h3><p><strong>Identify the long-lived network connections.</strong></p><h4 id="tcp" tabindex="-1">TCP <a class="header-anchor" href="#tcp" aria-label="Permalink to &quot;TCP&quot;">​</a></h4><p><strong>（1）3-Way Handshake Connection Start</strong></p><p>SYN, SYN/ACK, ACK</p><div class="language-mermaid"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">sequenceDiagram</span></span>
<span class="line"><span style="color:#A6ACCD;">    Client</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">Server</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">SYN</span></span>
<span class="line"><span style="color:#A6ACCD;">    Server</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">Client</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">SYN/ACK</span></span>
<span class="line"><span style="color:#A6ACCD;">    Client</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">Server</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ACK</span></span></code></pre></div><p><strong>（2）4-Way Handshake Connection End</strong></p><p>FIN, ACK, FIN, ACK</p><div class="language-mermaid"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">sequenceDiagram</span></span>
<span class="line"><span style="color:#A6ACCD;">    Client</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">Server</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">FIN</span></span>
<span class="line"><span style="color:#A6ACCD;">    Server</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">Client</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ACK</span></span>
<span class="line"><span style="color:#A6ACCD;">    Server</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">Client</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">FIN</span></span>
<span class="line"><span style="color:#A6ACCD;">    Client</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">Server</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ACK</span></span></code></pre></div><h4 id="udp" tabindex="-1">UDP <a class="header-anchor" href="#udp" aria-label="Permalink to &quot;UDP&quot;">​</a></h4><p>UDP 不同于 TCP 是 stateless protocols</p><p>会话在看到第一个 UDP 数据包时开始，在时间窗口的持续时间内不再看到 UDP 数据包时结束</p><h3 id="beacons" tabindex="-1">Beacons <a class="header-anchor" href="#beacons" aria-label="Permalink to &quot;Beacons&quot;">​</a></h3><p>Identify command &amp; control (C2) sessions using <strong>regular connections</strong> between two IP addresses, in other words, <strong>finding the connections that happen on regular time intervals</strong>.</p><p>Beacon 是一种轻量级的通信后门程序，通常用于在受害者计算机上建立持久性访问权限，并与攻击者的控制服务器进行通信</p><p>安全设计</p><ul><li>Beacon 使用团队服务器的公钥加密传输的元数据，只有团队服务器才能解密这些信息</li><li>Beacon 传输 Payload 到目标系统时，会验证团队服务器密钥，确保只接受来自团队服务器的任务</li><li>设置睡眠（Sleep）和抖动（Jitter）时间，Sleep 控制 Beacon 在再次请求前必须睡眠多长时间，Jitter 会改变睡眠时间，从而显示出随机性</li><li>……</li></ul><h4 id="通信模式" tabindex="-1">通信模式 <a class="header-anchor" href="#通信模式" aria-label="Permalink to &quot;通信模式&quot;">​</a></h4><ul><li><strong>异步式通信</strong>：Beacon 固定一段时间（由 Sleep 时间决定，可调整）向 Teamserver 发起通信，接受本次命令并回传上次执行命令后的结果</li><li><strong>交互式通信（Sleep 0）</strong>：由 Client 发出的指令通过 Teamserver（或再经过外部 C2）直接转发给 Beacon 并执行命令</li></ul><h4 id="分类" tabindex="-1">分类 <a class="header-anchor" href="#分类" aria-label="Permalink to &quot;分类&quot;">​</a></h4><p><strong>（1）HTTP (S) Beacon</strong></p><ul><li>相比 HTTP Beacon ，HTTPS Beacon 多了 SSL/TLS 协议，可以保证数据传输中信息不被截取或发生中间人攻击等</li><li>一般情况下，使用 Get 方式请求任务，使用 Post 方式回传数据</li></ul><div class="language-mermaid"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">sequenceDiagram</span></span>
<span class="line"><span style="color:#A6ACCD;">    Teamserver</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">HTTP(S) Beacon</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">HTTP(S)-Get</span></span>
<span class="line"><span style="color:#A6ACCD;">    HTTP(S) Beacon</span><span style="color:#89DDFF;font-style:italic;">-&gt;&gt;</span><span style="color:#A6ACCD;">Teamserver</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">HTTP(S)-Post</span></span></code></pre></div><p><strong>（2）SMB Beacon</strong></p><ul><li>SMB(Server Message Block)，该协议最初由微软开发，用于在 Windows 系统中实现文件和打印机共享，后来被广泛用于其他操作系统和网络设备中，我们常用的内网目录共享有些就是通过 SMB 协议实现的 <ul><li>命名管道（Named Pipe）：适用于持久性、跨进程、双向通信的场景</li><li>匿名管道（Anonymous Pipe）：适用于临时、有亲缘关系的进程间的单向数据传递</li></ul></li><li>使用命名管道并通过一个父 Beacon 进行通信，管道通信的进程可以是本地主机上的两个进程，也可以和远程主机上的进程通过网络进行通信</li><li>Beacon Covert Peer-to-Peer Communication（隐蔽点对点通信）</li><li>Beacon Peer as a Payload（作为 Payload 通信）</li></ul><p><strong>（3）DNS/DoH Beacon</strong></p><ul><li>DNS 协议可以使用 UDP 或者 TCP 进行传输，使用的端口号都为 53</li><li>DNS Beacon 同时利用了两种查询方式 <ul><li>迭代查询</li><li>递归查询</li></ul></li><li>数据传递方式，DNS Beacon 支持三种 <ul><li>A 记录（mode dns）：A 记录是最常见的 DNS 记录形式，一个 A 记录指向一个网站或域名的 IP 地址</li><li>AAAA 记录（mode dns6）：AAAA 记录是 IPv6 协议的一部分，能被用来为互联网上的主机分配 IPv6 地址</li><li>TXT 记录（mode dns-txt）：允许以文本格式添加关于域名的额外信息，是 DNS Beacon 的默认传递方式</li></ul></li><li>DNS Beacon 与 HTTP(S) Beacon 最大的区别是心跳时不会主动回传被控端的数据，仅有一个最后通联时间返回，使用 Beacon 控制台输入 <code>checkin</code> 可使心跳时返回数据，但如果通过 DNS Beacon 对受控主机执行命令时则会自动执行 <code>checkin</code> 返回数据</li></ul><p><strong>（4）TCP Beacon</strong></p><ul><li>TCP Beacon 使用 TCP socket 通过父 Beacon 进行通信，且对同一主机和跨网主机都适用</li><li>TCP Beacon 整体来说与 SMB Beacon 的特性相同，都需要从父 Beacon 对它3进行控制，包括兼容性方面也与 SMB Beacon 一致</li></ul><p><strong>（5）ICMP Beacon</strong></p><p><strong>（6）FTP Beacon</strong></p><p><strong>（7）IMAP Beacon</strong></p><p><strong>（8）MAPI Beacon</strong></p><h4 id="检测原理" tabindex="-1">检测原理 <a class="header-anchor" href="#检测原理" aria-label="Permalink to &quot;检测原理&quot;">​</a></h4>`,40),d=l('<p>对同源目的 IP 间的通信进行分数计算得到 score，其值分布为 0~1 之间，趋近 1 则疑似 beacon 通信行为</p><p>根据<strong>通信间隔</strong>和<strong>数据包大小</strong>的特征，分别计算出 <strong>tsScore</strong> 和 <strong>dsScore</strong>，最后取均值得到 <strong>score</strong></p><p><strong>1、通信间隔</strong></p><p><strong>（1）偏度 tsSkewScore</strong></p><p>采用 Bowley 偏度公式来度量对称性，所谓的偏度系数，适用于描述曲线形状的对称性，其值在 1 到 -1 之间，分别代表着正偏斜或负偏斜</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Negative_and_positive_skew_diagrams_%28English%29.svg/1280px-Negative_and_positive_skew_diagrams_%28English%29.svg.png" alt="skew"></p><p>具体计算时需要对数据集按大小顺序作四等分，在三个分位点依次取值：tsLow(Q1)，tsMid(Q2)，tsHigh(Q3)</p>',7),h=s("p",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mi",null,"B"),s("mi",null,"o"),s("mi",null,"w"),s("mi",null,"l"),s("mi",null,"e"),s("mi",null,"y"),s("mtext",null," "),s("mi",null,"S"),s("mi",null,"k"),s("mi",null,"e"),s("mi",null,"w"),s("mi",null,"n"),s("mi",null,"e"),s("mi",null,"s"),s("mi",null,"s"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"Q"),s("mn",null,"1"),s("mo",null,"+"),s("mi",null,"Q"),s("mn",null,"3"),s("mo",null,"−"),s("mn",null,"2"),s("mi",null,"Q"),s("mn",null,"2")]),s("mrow",null,[s("mi",null,"Q"),s("mn",null,"3"),s("mo",null,"−"),s("mi",null,"Q"),s("mn",null,"1")])])]),s("annotation",{encoding:"application/x-tex"},"Bowley \\ Skewness = \\frac{Q1 + Q3 - 2Q2}{Q3 - Q1}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"0.924439em"}}),s("span",{class:"strut bottom",style:{height:"1.4055469999999999em","vertical-align":"-0.481108em"}}),s("span",{class:"base textstyle uncramped"},[s("span",{class:"mord mathit",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02691em"}},"w"),s("span",{class:"mord mathit",style:{"margin-right":"0.01968em"}},"l"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit",style:{"margin-right":"0.03588em"}},"y"),s("span",{class:"mord mspace"}," "),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit",style:{"margin-right":"0.02691em"}},"w"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mrel"},"="),s("span",{class:"mord reset-textstyle textstyle uncramped"},[s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.345em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord scriptstyle cramped"},[s("span",{class:"mord mathit"},"Q"),s("span",{class:"mord mathrm"},"3"),s("span",{class:"mbin"},"−"),s("span",{class:"mord mathit"},"Q"),s("span",{class:"mord mathrm"},"1")])])]),s("span",{style:{top:"-0.22999999999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped frac-line"})]),s("span",{style:{top:"-0.44610799999999995em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle uncramped"},[s("span",{class:"mord scriptstyle uncramped"},[s("span",{class:"mord mathit"},"Q"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mbin"},"+"),s("span",{class:"mord mathit"},"Q"),s("span",{class:"mord mathrm"},"3"),s("span",{class:"mbin"},"−"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathit"},"Q"),s("span",{class:"mord mathrm"},"2")])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),a("​")])])]),s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])]),a("​")],-1),u=s("blockquote",null,[s("p",null,"注：如果分母为 0，Q2 = Q1 或 Q2 = Q3，则计算结果不可靠，tsSkew 取 0")],-1),y=s("p",null,"最后根据 tsSkew 算出：tsSkewScore = 1 – \\left| tsSkew \\right| 更低的偏度值取得更高的分数",-1),D=s("p",null,[s("strong",null,"（2）分散度 tsMadmScore")],-1),g=s("p",null,"MADM（Median Absolute Deviation about the Median）",-1),F=s("p",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"M"),s("mi",null,"a"),s("mi",null,"d"),s("mi",null,"m"),s("mo",null,"="),s("mi",null,"m"),s("mi",null,"e"),s("mi",null,"d"),s("mi",null,"i"),s("mi",null,"a"),s("mi",null,"n"),s("mo",null,"("),s("mi",{mathvariant:"normal"},"∣"),s("mo",null,"["),s("mi",null,"x"),s("mo",null,"]"),s("mo",null,"−"),s("mi",null,"m"),s("mi",null,"e"),s("mi",null,"d"),s("mi",null,"i"),s("mi",null,"a"),s("mi",null,"n"),s("mo",null,"["),s("mi",null,"x"),s("mo",null,"]"),s("mi",{mathvariant:"normal"},"∣"),s("mo",null,")")]),s("annotation",{encoding:"application/x-tex"},"tsMadm = median(|[x] - median[x]|)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"0.75em"}}),s("span",{class:"strut bottom",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"base textstyle uncramped"},[s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit"},"d"),s("span",{class:"mord mathit"},"m"),s("span",{class:"mrel"},"="),s("span",{class:"mord mathit"},"m"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit"},"d"),s("span",{class:"mord mathit"},"i"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathrm"},"∣"),s("span",{class:"mopen"},"["),s("span",{class:"mord mathit"},"x"),s("span",{class:"mclose"},"]"),s("span",{class:"mbin"},"−"),s("span",{class:"mord mathit"},"m"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit"},"d"),s("span",{class:"mord mathit"},"i"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mopen"},"["),s("span",{class:"mord mathit"},"x"),s("span",{class:"mclose"},"]"),s("span",{class:"mord mathrm"},"∣"),s("span",{class:"mclose"},")")])])]),a(" 计算每个元素与中位数差值的绝对值，再取这些绝对值的中位数")],-1),C=l(`<p>以 30 s 为阈值，超出则分数记为 0：</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">tsMadmScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1.0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">tsMadm</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.0</span></span>
<span class="line"><span style="color:#A6ACCD;">http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">tsMadmScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">tsMadmScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">apply</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">lambda</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">x</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#82AAFF;"> x </span><span style="color:#89DDFF;">&lt;</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#82AAFF;"> x</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p><strong>（3）通信次数 tsConnCountScore</strong></p>`,3),A=s("p",null,[a("利用通信的持续时间和连接次数计算得到："),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"n"),s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"u"),s("mi",null,"n"),s("mi",null,"t"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"n"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"t"),s("mi",null,"i"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"u"),s("mi",null,"n")]),s("mrow",null,[s("mo",null,"("),s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"n"),s("mi",null,"D"),s("mi",null,"i"),s("mi",null,"v"),s("mi",{mathvariant:"normal"},"/"),s("mn",null,"1"),s("mn",null,"0"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"0"),s("mo",null,")")])])]),s("annotation",{encoding:"application/x-tex"},"tsConnCountScore = \\frac{ConnectionCoun}{(tsConnDiv / 10.0)}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"0.872331em"}}),s("span",{class:"strut bottom",style:{height:"1.392331em","vertical-align":"-0.52em"}}),s("span",{class:"base textstyle uncramped"},[s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"u"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mrel"},"="),s("span",{class:"mord reset-textstyle textstyle uncramped"},[s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.34500000000000003em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord scriptstyle cramped"},[s("span",{class:"mopen"},"("),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"D"),s("span",{class:"mord mathit"},"i"),s("span",{class:"mord mathit",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"mord mathrm"},"/"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mclose"},")")])])]),s("span",{style:{top:"-0.22999999999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped frac-line"})]),s("span",{style:{top:"-0.394em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle uncramped"},[s("span",{class:"mord scriptstyle uncramped"},[s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"i"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"u"),s("span",{class:"mord mathit"},"n")])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),a("​")])])]),s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])]),a("​")],-1),f=s("ul",null,[s("li",null,"ConnectionCount 代表通信次数"),s("li",null,[a("tsConnDiv 由通信起止时间除以固定的连接频率得来，此处该值取为 "),s("strong",null,"10 秒")])],-1),_=s("p",null,"最后得分如果大于 1，则向下舍入取 1，因为连接得越频繁，越有可能是 beacon 通信",-1),S=s("p",null,[s("strong",null,"（4）综上")],-1),x=s("p",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"S"),s("mi",null,"k"),s("mi",null,"e"),s("mi",null,"w"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"+"),s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"M"),s("mi",null,"A"),s("mi",null,"D"),s("mi",null,"M"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"+"),s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"n"),s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"u"),s("mi",null,"n"),s("mi",null,"t"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e")]),s("mrow",null,[s("mn",null,"3"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"0")])])]),s("annotation",{encoding:"application/x-tex"},"tsScore = \\frac{tsSkewScore + tsMADMScore + tsConnCountScore}{3.0}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"0.8801079999999999em"}}),s("span",{class:"strut bottom",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),s("span",{class:"base textstyle uncramped"},[s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mrel"},"="),s("span",{class:"mord reset-textstyle textstyle uncramped"},[s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.345em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord scriptstyle cramped"},[s("span",{class:"mord mathrm"},"3"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"0")])])]),s("span",{style:{top:"-0.22999999999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped frac-line"})]),s("span",{style:{top:"-0.394em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle uncramped"},[s("span",{class:"mord scriptstyle uncramped"},[s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit",style:{"margin-right":"0.02691em"}},"w"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mbin"},"+"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mord mathit"},"A"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"D"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mbin"},"+"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"u"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e")])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),a("​")])])]),s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])],-1),b=l(`<p><strong>2、数据包大小</strong></p><p>同理可得</p><p><strong>（1）偏度 dsSkewScore</strong></p><p><strong>（2）分散度 dsMadmScore</strong></p><p>以 32 字节为阈值，超出则分数记为 0：</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dsMadmScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1.0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dsMadm</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">32.0</span></span>
<span class="line"><span style="color:#A6ACCD;">http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dsMadmScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dsMadmScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">apply</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">lambda</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">x</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#82AAFF;"> x </span><span style="color:#89DDFF;">&lt;</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#82AAFF;"> x</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p><strong>（3）dsSmallnessScore</strong></p><p>由于 beacon 通常都是较小的数据包，这里采用 dsSmallnessScore 作为衡量指标</p><p>如果数据包大小的众数(Mode)超过 <strong>65 Kb</strong>，则得分为 0</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dsSmallnessScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> http_df</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">data_size</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">apply</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">lambda</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">x</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">-</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">np</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">argmax</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">np</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">bincount</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">))</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">/</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">65535</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dsSmallnessScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> http_df</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dsSmallnessScore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">apply</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">lambda</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">x</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#82AAFF;"> x </span><span style="color:#89DDFF;">&lt;</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#82AAFF;"> x</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p><strong>（4）综上</strong></p>`,11),z=s("p",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mi",null,"d"),s("mi",null,"s"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"d"),s("mi",null,"s"),s("mi",null,"S"),s("mi",null,"k"),s("mi",null,"e"),s("mi",null,"w"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"+"),s("mi",null,"d"),s("mi",null,"s"),s("mi",null,"M"),s("mi",null,"A"),s("mi",null,"D"),s("mi",null,"M"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"+"),s("mi",null,"d"),s("mi",null,"s"),s("mi",null,"S"),s("mi",null,"m"),s("mi",null,"a"),s("mi",null,"l"),s("mi",null,"l"),s("mi",null,"n"),s("mi",null,"e"),s("mi",null,"s"),s("mi",null,"s"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e")]),s("mrow",null,[s("mn",null,"3"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"0")])])]),s("annotation",{encoding:"application/x-tex"},"dsScore = \\frac{dsSkewScore + dsMADMScore + dsSmallnessScore}{3.0}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"0.8801079999999999em"}}),s("span",{class:"strut bottom",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),s("span",{class:"base textstyle uncramped"},[s("span",{class:"mord mathit"},"d"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mrel"},"="),s("span",{class:"mord reset-textstyle textstyle uncramped"},[s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.345em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord scriptstyle cramped"},[s("span",{class:"mord mathrm"},"3"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"0")])])]),s("span",{style:{top:"-0.22999999999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped frac-line"})]),s("span",{style:{top:"-0.394em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle uncramped"},[s("span",{class:"mord scriptstyle uncramped"},[s("span",{class:"mord mathit"},"d"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit",style:{"margin-right":"0.02691em"}},"w"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mbin"},"+"),s("span",{class:"mord mathit"},"d"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mord mathit"},"A"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"D"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mbin"},"+"),s("span",{class:"mord mathit"},"d"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"m"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit",style:{"margin-right":"0.01968em"}},"l"),s("span",{class:"mord mathit",style:{"margin-right":"0.01968em"}},"l"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e")])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),a("​")])])]),s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])],-1),k=s("p",null,[s("strong",null,"3、最终得分")],-1),v=s("p",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mi",null,"s"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e"),s("mo",null,"+"),s("mi",null,"t"),s("mi",null,"s"),s("mi",null,"S"),s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"e")]),s("mrow",null,[s("mn",null,"2"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"0")])])]),s("annotation",{encoding:"application/x-tex"},"score = \\frac{tsScore + tsScore}{2.0}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"0.872331em"}}),s("span",{class:"strut bottom",style:{height:"1.217331em","vertical-align":"-0.345em"}}),s("span",{class:"base textstyle uncramped"},[s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mrel"},"="),s("span",{class:"mord reset-textstyle textstyle uncramped"},[s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.345em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord scriptstyle cramped"},[s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"0")])])]),s("span",{style:{top:"-0.22999999999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped frac-line"})]),s("span",{style:{top:"-0.394em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle uncramped"},[s("span",{class:"mord scriptstyle uncramped"},[s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mbin"},"+"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"s"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e")])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),a("​")])])]),s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])],-1),P=l('<h3 id="dns" tabindex="-1">DNS <a class="header-anchor" href="#dns" aria-label="Permalink to &quot;DNS&quot;">​</a></h3><h3 id="ja3-ja3s-hashes" tabindex="-1">JA3/JA3S Hashes <a class="header-anchor" href="#ja3-ja3s-hashes" aria-label="Permalink to &quot;JA3/JA3S Hashes&quot;">​</a></h3><h3 id="jarm" tabindex="-1">JARM <a class="header-anchor" href="#jarm" aria-label="Permalink to &quot;JARM&quot;">​</a></h3><h2 id="reference" tabindex="-1">Reference <a class="header-anchor" href="#reference" aria-label="Permalink to &quot;Reference&quot;">​</a></h2><ul><li><a href="https://c2matrix.webflow.io/matrix" target="_blank" rel="noreferrer">https://c2matrix.webflow.io/matrix</a></li><li><a href="https://activecm.github.io/threat-hunting-labs/basic_usage/" target="_blank" rel="noreferrer">https://activecm.github.io/threat-hunting-labs/basic_usage/</a></li><li><a href="https://zhuanlan.zhihu.com/p/656697509?utm_psn=1754463206125658112" target="_blank" rel="noreferrer">https://zhuanlan.zhihu.com/p/656697509?utm_psn=1754463206125658112</a></li><li><a href="https://wikileaks.org/vault7/document/hive-Operating_Environment/hive-Operating_Environment.pdf" target="_blank" rel="noreferrer">https://wikileaks.org/vault7/document/hive-Operating_Environment/hive-Operating_Environment.pdf</a></li><li><a href="https://www.anquanke.com/post/id/266379" target="_blank" rel="noreferrer">https://www.anquanke.com/post/id/266379</a></li><li><a href="https://en.m.wikipedia.org/wiki/Skewness#Quantile-based_measures" target="_blank" rel="noreferrer">https://en.m.wikipedia.org/wiki/Skewness#Quantile-based_measures</a></li><li><a href="https://github.com/activecm/rita/blob/master/pkg/beacon/analyzer.go" target="_blank" rel="noreferrer">https://github.com/activecm/rita/blob/master/pkg/beacon/analyzer.go</a></li></ul>',5);function T(w,B,M,E,N,q){const n=p("font");return i(),r("div",null,[c,s("ul",null,[s("li",null,[t(n,{color:"red"},{default:e(()=>[a("理想的 beacon 通信行为应该具有通信间隔和数据大小呈现**对称分布**的特征")]),_:1})]),s("li",null,[t(n,{color:"red"},{default:e(()=>[a("理想的 beacon 通信行为在其通信间隔的**中位数**周围应该具有很低的**分散度**")]),_:1})]),s("li",null,[t(n,{color:"red"},{default:e(()=>[a("在行为特征上，beacon 通信时往往具有**较高的连接数**")]),_:1})])]),d,h,u,y,D,g,F,C,A,f,_,S,x,b,z,k,v,P])}const H=o(m,[["render",T]]);export{Q as __pageData,H as default};
